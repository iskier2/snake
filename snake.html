<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .pole {
            width: 23px;
            height: 23px;
            border: solid black 1px;
            float: left;
        }

        #container {
            width: 575px;
            height: 575px;
            border: solid black 1px;
        }
    </style>
</head>

<body>
    <div id="container"></div>
    <script>
        function init() {
            plansza = []
            for (let i = 0; i < 23; i++) {
                plansza[i] = []
                for (let j = 0; j < 23; j++) {
                    plansza[i][j] = pole(i, j)
                    plansza[i][j].createDiv()
                }
            }
            console.log(plansza)
            pojawWeza()
            dlugosc = 1
            sterowanie()
            interval = setInterval(klatka, 100)
            dropJedzonka()
        }
        init()
        function pole(i, j) {
            let value = 0
            if (i == 0 || i == 22 || j == 0 || j == 22) {
                value = -1
            }
            return {
                i: i,
                j: j,
                id: i + "_" + j,
                divId: "pole" + i + "_" + j,
                value: value,
                createDiv: function () {
                    let div = document.createElement("div")
                    div.classList.add("pole")
                    div.id = i + "_" + j
                    div.style.backgroundColor = "#008000"
                    if (i == 0 || i == 22 || j == 0 || j == 22) {
                        div.style.backgroundColor = "#006000"
                    }
                    if (j == 0)
                        div.style.clear = "both"
                    document.getElementById("container").appendChild(div)
                }
            }
        }
        function pojawWeza() {
            plansza[11][11].value = 1
        }
        function klatka() {
            let check = false
            for (i in plansza) {
                for (j in plansza[i]) {
                    if (plansza[i][j].value == 2 && check == false) {
                        check = true
                        switch (kierunek) {
                            case 87:
                                console.log("gora")
                                sprawdzanie(parseInt(i) - 1, j)
                                plansza[parseInt(i) - 1][j].value = 1
                                break
                            case 83:
                                console.log("dol")
                                sprawdzanie(parseInt(i) + 1, j)
                                plansza[parseInt(i) + 1][j].value = 1
                                break
                            case 65:
                                console.log("lewo")
                                sprawdzanie(i, parseInt(j) - 1)
                                plansza[i][parseFloat(j) - 1].value = 1
                                break
                            case 68:
                                console.log("prawo")
                                sprawdzanie(i, parseInt(j) + 1)
                                plansza[i][parseFloat(j) + 1].value = 1
                                break
                        }
                    }
                }
            }
            for (i in plansza) {
                for (j in plansza[i]) {

                    if (plansza[i][j].value > dlugosc) {
                        plansza[i][j].value = 0
                    }
                    if (plansza[i][j].value > 0) {
                        document.getElementById(plansza[i][j].id).style.backgroundColor = "red"
                        plansza[i][j].value++
                    }
                    if (plansza[i][j].value == 0) {
                        document.getElementById(plansza[i][j].id).style.backgroundColor = "green"
                    }
                    if (plansza[i][j].value == -2) {
                        document.getElementById(plansza[i][j].id).style.backgroundColor = "yellow"
                    }
                    //document.getElementById(plansza[i][j].id).innerHTML = plansza[i][j].value

                }
            }
        }
        function sterowanie() {
            dlugosc = 1
            kierunek = 68
            document.onkeydown = function (event) {
                kierunek = event.keyCode
                console.log(kierunek)
            }
        }
        function sprawdzanie(i, j) {
            if (plansza[i][j].value == -1 || plansza[i][j].value > 0) {
                alert("przegrałeś")
                window.location.reload(true);
            }
            if (plansza[i][j].value == -2) {
                dlugosc++
                dropJedzonka()
            }
        }
        function dropJedzonka() {
            let i = Math.floor(Math.random() * 22) + 1
            let j = Math.floor(Math.random() * 22) + 1
            if (plansza[i][j].value == 0) {
                plansza[i][j].value = -2
                document.getElementById(plansza[i][j].id).backgroundColor = "yellow"
                console.log(plansza[i][j])
            }
            else
                dropJedzonka()
        }
    </script>
</body>

</html>